---
- hosts: localhost
  connection: local
  gather_facts: no

  tasks:
    - template:
        src: templates/globals.yml.j2
        dest: globals.yml
        mode: '0600'
        backup: yes
    - template:
        src: templates/hosts.j2
        dest: hosts
        backup: yes
    - debug:
        msg:
          - "A new globals file has been outputted to this directory."
          - "Please have a look and fill in any settings specific to your deployment."

  vars_prompt:
    - name: ciab_admin_email
      private: no
      prompt: |
        Please enter a contact email for an administrator.
        This will be used as the email address for the OpenStack admin user.
    - name: ciab_region_name
      private: no
      default: CIAB
      prompt: |
        Please enter a name for the site deployment. For associate sites, a
        good convention to follow is "CHI@" followed by an abbreviation of
        the hosting institution or organization. For example, University of
        Chicago's site name is "CHI@UC"
    - name: ciab_private_interface
      private: no
      default: eno1
      prompt: Network interface for *private* (east-west) traffic on controller node?
    - name: ciab_private_ip
      private: no
      prompt: IP address on *private* interface for controller node?
    - name: ciab_private_subnet
      private: no
      prompt: IPv4 subnet (CIDR) on *private* interface for controller node?
    - name: ciab_private_gateway
      private: no
      prompt: IPv4 gateway on *private* interface for controller node?
    - name: ciab_public_interface
      private: no
      default: eno1
      prompt: Network interface for *public* (north-south) traffic on controller node?
    - name: ciab_public_ip
      private: no
      prompt: IP address on *public* interface for controller node?
    - name: ciab_public_subnet
      private: no
      prompt: IPv4 subnet (CIDR) on *public* interface for controller node?
    - name: ciab_public_gateway
      private: no
      prompt: IPv4 gateway on *public* interface for controller node?
